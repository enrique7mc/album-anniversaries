<!-- Sticky Header -->
<header
  class="sticky top-0 z-50 bg-bg-secondary/95 backdrop-blur-sm border-b border-bg-tertiary"
>
  <div class="container mx-auto px-4 h-16 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <lucide-icon
        name="disc"
        class="w-6 h-6 text-accent-primary"
      ></lucide-icon>
      <h1 class="text-xl font-display font-semibold">{{ title }}</h1>
    </div>

    <div class="flex items-center gap-4">
      <!-- Dropdown filter -->
      <div class="relative" *ngIf="accessToken">
        <button
          (click)="toggleDropdown()"
          class="flex items-center gap-2 px-4 py-2 bg-bg-tertiary rounded-md hover:bg-accent-primary/10 transition-colors duration-200"
        >
          <span class="text-sm">{{ currentFilterLabel }}</span>
          <lucide-icon name="chevron-down" class="w-4 h-4"></lucide-icon>
        </button>

        <div
          *ngIf="dropdownOpen"
          class="absolute right-0 mt-2 w-48 bg-bg-secondary rounded-md shadow-lg-dark border border-bg-tertiary animate-fade-in"
        >
          <button
            (click)="setAnniversaryRange('week')"
            class="w-full px-4 py-2 text-left hover:bg-bg-tertiary transition-colors flex items-center justify-between"
          >
            <span>Last Week</span>
            <lucide-icon
              *ngIf="anniversaryRange === 'week'"
              name="check"
              class="w-4 h-4 text-accent-primary"
            >
            </lucide-icon>
          </button>
          <button
            (click)="setAnniversaryRange('month')"
            class="w-full px-4 py-2 text-left hover:bg-bg-tertiary transition-colors flex items-center justify-between"
          >
            <span>Last Month</span>
            <lucide-icon
              *ngIf="anniversaryRange === 'month'"
              name="check"
              class="w-4 h-4 text-accent-primary"
            >
            </lucide-icon>
          </button>
        </div>
      </div>

      <!-- Logout button -->
      <button *ngIf="accessToken" (click)="logout()" class="btn-icon">
        <lucide-icon name="log-out" class="w-5 h-5"></lucide-icon>
      </button>
    </div>
  </div>
</header>

<!-- Progress Bar -->
<div *ngIf="loading" class="h-1 bg-bg-tertiary overflow-hidden">
  <div
    class="h-full bg-gradient-to-r from-accent-primary to-accent-hover animate-pulse w-full"
  ></div>
</div>

<!-- Login Page -->
<div
  *ngIf="!accessToken"
  class="login-hero min-h-screen flex items-center justify-center px-4 relative overflow-hidden"
>
  <!-- Atmospheric Background -->
  <div class="hero-bg-glow"></div>

  <!-- Main Content -->
  <div
    class="relative z-10 max-w-5xl mx-auto text-center space-y-8 animate-hero-enter"
  >
    <!-- Icon with Glow -->
    <div class="flex justify-center mb-6">
      <div class="relative">
        <div
          class="absolute inset-0 blur-2xl bg-accent-primary/30 rounded-full scale-150"
        ></div>
        <lucide-icon
          name="disc"
          class="w-24 h-24 text-accent-primary relative animate-spin-slow"
        >
        </lucide-icon>
      </div>
    </div>

    <!-- Hero Headline -->
    <h1 class="hero-headline">
      Rediscover Your
      <span class="hero-gradient">Musical Past</span>
    </h1>

    <!-- Supporting Copy -->
    <p class="hero-subtitle">
      Celebrate the albums that defined moments in music history.<br />
      Journey through anniversaries from your most-loved artists.
    </p>

    <!-- CTA Button -->
    <div class="flex justify-center pt-6">
      <button (click)="login()" class="hero-cta group">
        <span class="relative z-10 flex items-center gap-3">
          <lucide-icon name="music" class="w-6 h-6"></lucide-icon>
          <span class="font-semibold tracking-wide">Connect with Spotify</span>
          <lucide-icon
            name="arrow-right"
            class="w-5 h-5 transition-transform group-hover:translate-x-1"
          ></lucide-icon>
        </span>
        <div class="hero-cta-glow"></div>
      </button>
    </div>

    <!-- Subtle Feature Hints -->
    <div class="pt-12 flex justify-center gap-12 text-text-tertiary text-sm">
      <div class="flex items-center gap-2">
        <lucide-icon name="calendar" class="w-4 h-4"></lucide-icon>
        <span>Anniversary Tracking</span>
      </div>
      <div class="flex items-center gap-2">
        <lucide-icon name="sparkles" class="w-4 h-4"></lucide-icon>
        <span>Recent Releases</span>
      </div>
      <div class="flex items-center gap-2">
        <lucide-icon name="list-music" class="w-4 h-4"></lucide-icon>
        <span>Queue Integration</span>
      </div>
    </div>
  </div>
</div>

<!-- Main Content -->
<main *ngIf="!loading && accessToken" class="container mx-auto px-4 py-8">
  <!-- Week/Month Anniversary Section -->
  <h1 #weekSection class="text-3xl font-display font-bold mb-6">
    These albums were released this
    {{ anniversaryRange === 'week' ? 'week' : 'month' }} in the past!
  </h1>
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-12">
    <app-artist-card
      *ngFor="let artist of artists$ | async"
      [artist]="artist"
    ></app-artist-card>
  </div>

  <!-- Recent Albums Section -->
  <h1 #yearSection class="text-3xl font-display font-bold mb-6">
    Albums released last year
  </h1>
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <app-artist-card
      *ngFor="let artist of artistsWithRecentAlbums$ | async"
      [artist]="artist"
    ></app-artist-card>
  </div>
</main>

<!-- Scroll-to-Top FAB -->
<button
  *ngIf="showScrollToTop && accessToken"
  (click)="scrollToTop()"
  class="fixed bottom-6 right-6 w-14 h-14 rounded-full bg-accent-primary hover:bg-accent-hover shadow-glow hover:shadow-lg-dark transition-all duration-250 hover:-translate-y-1 flex items-center justify-center animate-fade-in"
  aria-label="Scroll to top"
>
  <lucide-icon name="arrow-up" class="w-6 h-6 text-white"></lucide-icon>
</button>
