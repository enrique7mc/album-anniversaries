<!-- Sticky Header -->
<header
  class="sticky top-0 z-50 bg-bg-secondary/95 backdrop-blur-sm border-b border-bg-tertiary"
>
  <div class="container mx-auto px-4 h-16 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <lucide-icon
        name="disc"
        class="w-6 h-6 text-accent-primary"
      ></lucide-icon>
      <h1 class="text-xl font-display font-semibold">{{ title }}</h1>
    </div>

    <div class="flex items-center gap-4">
      <!-- Dropdown filter -->
      <div class="relative" *ngIf="accessToken">
        <button
          (click)="toggleDropdown()"
          class="flex items-center gap-2 px-4 py-2 bg-bg-tertiary rounded-md hover:bg-accent-primary/10 transition-colors duration-200"
        >
          <span class="text-sm">{{ currentFilterLabel }}</span>
          <lucide-icon name="chevron-down" class="w-4 h-4"></lucide-icon>
        </button>

        <div
          *ngIf="dropdownOpen"
          class="absolute right-0 mt-2 w-48 bg-bg-secondary rounded-md shadow-lg-dark border border-bg-tertiary animate-fade-in"
        >
          <button
            (click)="setAnniversaryRange('week')"
            class="w-full px-4 py-2 text-left hover:bg-bg-tertiary transition-colors flex items-center justify-between"
          >
            <span>Last Week</span>
            <lucide-icon
              *ngIf="anniversaryRange === 'week'"
              name="check"
              class="w-4 h-4 text-accent-primary"
            >
            </lucide-icon>
          </button>
          <button
            (click)="setAnniversaryRange('month')"
            class="w-full px-4 py-2 text-left hover:bg-bg-tertiary transition-colors flex items-center justify-between"
          >
            <span>Last Month</span>
            <lucide-icon
              *ngIf="anniversaryRange === 'month'"
              name="check"
              class="w-4 h-4 text-accent-primary"
            >
            </lucide-icon>
          </button>
        </div>
      </div>

      <!-- Logout button -->
      <button *ngIf="accessToken" (click)="logout()" class="btn-icon">
        <lucide-icon name="log-out" class="w-5 h-5"></lucide-icon>
      </button>
    </div>
  </div>
</header>

<!-- Progress Bar -->
<div *ngIf="loading" class="h-1 bg-bg-tertiary overflow-hidden">
  <div
    class="h-full bg-gradient-to-r from-accent-primary to-accent-hover animate-pulse w-full"
  ></div>
</div>

<!-- Login Page -->
<div
  *ngIf="!accessToken"
  class="min-h-screen flex items-center justify-center px-4"
>
  <div
    class="bg-bg-secondary rounded-lg shadow-lg-dark p-8 max-w-md w-full animate-scale-in"
  >
    <div class="flex flex-col items-center text-center space-y-6">
      <lucide-icon name="music" class="w-16 h-16 text-accent-primary">
      </lucide-icon>
      <h2 class="text-2xl font-display font-semibold">Album Anniversaries</h2>
      <p class="text-text-tertiary">
        Discover albums celebrating anniversaries from your favorite artists
      </p>
      <button
        (click)="login()"
        class="btn-primary w-full flex items-center justify-center gap-2"
      >
        <lucide-icon name="log-in" class="w-5 h-5"></lucide-icon>
        <span>Connect with Spotify</span>
      </button>
    </div>
  </div>
</div>

<!-- Main Content -->
<main *ngIf="!loading && accessToken" class="container mx-auto px-4 py-8">
  <!-- Week/Month Anniversary Section -->
  <h1 #weekSection class="text-3xl font-display font-bold mb-6">
    These albums were released this
    {{ anniversaryRange === 'week' ? 'week' : 'month' }} in the past!
  </h1>
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-12">
    <app-artist-card
      *ngFor="let artist of artists$ | async"
      [artist]="artist"
    ></app-artist-card>
  </div>

  <!-- Recent Albums Section -->
  <h1 #yearSection class="text-3xl font-display font-bold mb-6">
    Albums released last year
  </h1>
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <app-artist-card
      *ngFor="let artist of artistsWithRecentAlbums$ | async"
      [artist]="artist"
    ></app-artist-card>
  </div>
</main>

<!-- Scroll-to-Top FAB -->
<button
  *ngIf="showScrollToTop && accessToken"
  (click)="scrollToTop()"
  class="fixed bottom-6 right-6 w-14 h-14 rounded-full bg-accent-primary hover:bg-accent-hover shadow-glow hover:shadow-lg-dark transition-all duration-250 hover:-translate-y-1 flex items-center justify-center animate-fade-in"
  aria-label="Scroll to top"
>
  <lucide-icon name="arrow-up" class="w-6 h-6 text-white"></lucide-icon>
</button>
